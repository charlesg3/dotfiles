# ── General ───────────────────────────────────────────────────────────────────

set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*:Tc"      # true colour (24-bit)
set -sg escape-time 10                  # no escape delay — critical for nvim
set -g focus-events on                  # pass focus events through to apps
set -g history-limit 50000

# ── Prefix ────────────────────────────────────────────────────────────────────

# Keep default Ctrl-b; Ctrl-b Ctrl-b sends it through to nested sessions
bind C-b send-prefix

# ── Mouse ─────────────────────────────────────────────────────────────────────

set -g mouse on

# ── Windows & panes ───────────────────────────────────────────────────────────

set -g base-index 1               # start windows at 1 (not 0)
setw -g pane-base-index 1         # start panes at 1
set -g renumber-windows on        # renumber windows when one is closed

# Open new splits / windows in the current working directory
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window   -c "#{pane_current_path}"

# Reload config in place
bind r source-file ~/.tmux.conf \; display "tmux.conf reloaded"

# ── Vim-style pane navigation ──────────────────────────────────────────────────

bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes (repeatable — hold prefix and tap H/J/K/L)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ── Copy mode (vi) ────────────────────────────────────────────────────────────

setw -g mode-keys vi
bind Enter copy-mode

bind -T copy-mode-vi v   send -X begin-selection
bind -T copy-mode-vi C-v send -X rectangle-toggle
bind -T copy-mode-vi Escape send -X cancel

# Clipboard — macOS uses pbcopy, Linux uses xclip/xsel
if-shell "uname | grep -q Darwin" \
    "bind -T copy-mode-vi y send -X copy-pipe-and-cancel 'pbcopy'"
if-shell "uname | grep -qv Darwin" \
    "bind -T copy-mode-vi y send -X copy-pipe-and-cancel 'xclip -in -selection clipboard 2>/dev/null || xsel --clipboard --input'"

# ── Panda colour palette ───────────────────────────────────────────────────────
#   bg         #1A1B1C     fg       #E6E6E6
#   lime       #A8F0A6     cyan     #45A9F9
#   orange     #FFB86C     pink     #FF75B5
#   comment    #676B79     hot-pink #FF2C6D

# ── Status bar ────────────────────────────────────────────────────────────────

set -g status on
set -g status-position bottom
set -g status-interval 5
set -g status-style             "bg=#1A1B1C,fg=#E6E6E6"

# Left: session name ( powerline arrow out)
set -g status-left              "#[bg=#A8F0A6,fg=#1A1B1C,bold] #S #[bg=#1A1B1C,fg=#A8F0A6,nobold]  "
set -g status-left-length       30

# Right: time / date
set -g status-right             "#[fg=#676B79] %H:%M  %d %b "
set -g status-right-length      30

# Window tabs — powerline arrows on the active tab
set -g window-status-separator  ""
setw -g window-status-format          "#[fg=#676B79,bg=#1A1B1C] #I  #W "
setw -g window-status-current-format "#[fg=#45A9F9,bg=#1A1B1C]#[fg=#1A1B1C,bg=#45A9F9,bold] #I  #W #[fg=#45A9F9,bg=#1A1B1C,nobold] "

# ── Pane borders ──────────────────────────────────────────────────────────────

set -g pane-border-style        "fg=#676B79"
set -g pane-active-border-style "fg=#45A9F9"

# ── Messages & selection highlight ────────────────────────────────────────────

set -g message-style         "bg=#FFB86C,fg=#1A1B1C,bold"
set -g message-command-style "bg=#FFB86C,fg=#1A1B1C"
set -g mode-style            "bg=#45A9F9,fg=#1A1B1C"
